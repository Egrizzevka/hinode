---
import { getCollection, type CollectionEntry } from "astro:content";
import { DateTime } from "luxon";

import type { GetStaticPaths } from "astro";

import Default from "@/layouts/Default.astro";

import Template from "@/components/materi/Template.astro";

export const getStaticPaths = (async ({ paginate }) => {
  const rekishiLessons = await getCollection("materi", ({ id }) =>
    id.startsWith("sejarah"),
  );

  const sortedRekishiLessons = rekishiLessons.sort((a, b) =>
    DateTime.fromFormat(b.data.created_at, "yyyy-M-d") >
    DateTime.fromFormat(a.data.created_at, "yyyy-M-d")
      ? 1
      : -1,
  );

  return paginate(sortedRekishiLessons, { pageSize: 2 });
}) satisfies GetStaticPaths;

export type Props = {
  page: {
    data: CollectionEntry<"materi">[];
  };
};

const { page } = Astro.props;
---

<Default
  title="List semua materi sejarah"
  description="Halaman yang menjelaskan semua materi sejarah yang ada"
>
  <Template data={page.data} currentPage="/sejarah" />
</Default>
